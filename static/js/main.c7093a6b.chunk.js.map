{"version":3,"sources":["app/steps/Steps.ts","app/redux/constants.ts","app/redux/reducer.ts","app/redux/store.ts","app/redux/actions.ts","app/GoToScreenButton.tsx","app/screens/MainMenu.tsx","app/screens/Instructions.tsx","app/Setting.tsx","app/Dropdown.tsx","app/screens/Settings.tsx","app/screens/Privacy.tsx","app/ErrorMessage.tsx","app/DownloadImageButton.tsx","app/steps/BetweenStep.tsx","app/compare-images/AutomaticCompare.tsx","app/compare-images/LeftRightSlider.tsx","app/compare-images/CrossfadeCompare.tsx","app/steps/ImageCompareView.tsx","app/TakeImageView.tsx","app/ImageUploadButton.tsx","app/ImageUpload.tsx","app/steps/GetImage.tsx","app/StepListView.tsx","app/screens/Steps.tsx","app/ScreenManager.tsx","app/App.tsx","index.tsx","serviceWorker.ts"],"names":["steps","addStep","name","canSkip","number","length","data","push","STEPS_CAM","STEPS_FILE","assertStepInBounds","step","throwError","isInBounds","Error","getLastAccessibleStepIndex","completedSteps","i","handle_completeStep","state","next","current","list","completed","Math","max","modifyImageState","oldSubState","newData","updateCount","reducer","action","console","warn","fallbackState","type","payload","imageStateCopy","images","imageName","after","imageData","before","src","img","document","createElement","onload","event","log","naturalWidth","naturalHeight","debug_print_image_size","handle_setImage","handle_goToStep","value","settings","imageSource","handle_setImageSource","useCam","screen","comparisonType","screenshotFormat","preferredResolution","overlayBeforeImage","DEFAULT_IMAGE_STATE","width","height","devTools","undefined","window","__REDUX_DEVTOOLS_EXTENSION__","trace","traceLimit","store","createStore","d","dispatch","setBeforeImage","setImage","setAfterImage","goToStep","setImageSource","setScreenshotFormat","GoToScreenButton","props","className","onClick","e","label","MainMenu","Instructions","Setting","show","hint","title","text","trigger","children","DropdownChooser","options","optionMap","entries","onChange","onValueChange","target","map","key","SOURCES","Map","set","IMG_FORMAT","IMG_SIZE","SettingsView","showWebcamSettings","this","onResolutionChange","checked","isBeforeOverlayEnabled","resString","res","split","w","Number","h","error","React","Component","connect","ownProps","PrivacyPolicy","href","ErrorMessage","message","BugMessage","DownloadImageButton","fileName","autoDetectFormat","imageDataUrl","match","format","debug","slice","detectImageFormat","download","buttonText","BetweenStepView","beforeImage","alt","AutomaticCompare","resembleCallback","setState","errorMessage","getImageDataUrl","diffImage","calculateDiffImage","afterImage","compare","output","errorType","largeImageThreshold","useCrossOrigin","outputDiff","scaleToSameSize","ignore","LeftRightSlider","leftImage","leftImageLabel","rightImage","rightImageLabel","sliderLineColor","handle","Fragment","MySlider","Slider","CrossfadeCompare","onOpacityChange","sliderValue","min","style","opacity","TYPES","ImageCompareView","x","renderContents","TakeImageView","webcamRef","photo","getScreenshot","onPhoto","createRef","bgImg","backgroundImage","getState","resolution","VIDEO_CONSTRAINTS","facingMode","ideal","ref","audio","videoConstraints","forceScreenshotSourceSize","ImageUploadButton","fileSelectionHandler","selectEvent","files","fileReader","FileReader","loadEvent","imgData","result","onSuccess","onerror","onError","readAsDataURL","ImageUrlUploader","hasError","image","renderFileInputButton","GetImageView","onImage","currentImage","TakePhotoView","ImageUpload","UploadImageView","StepListView","renderStep","classes","lastSelectableStep","currentStep","join","stepList","goToStepButton","Boolean","StepContentView","renderNextButtonIfPossible","GetImage","beforeImageData","afterImageData","nextStep","Settings","App","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch"],"mappings":"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","file":"static/js/main.c7093a6b.chunk.js","sourcesContent":["import * as C from '../redux/constants';\n\nexport interface StepData {\n  number: number,\n  name: string,\n  canSkip: boolean,\n}\n\nlet steps: StepData[] = [];\n\nfunction addStep(name: string, canSkip: boolean = false): number {\n  let number = steps.length;\n  let data: StepData = { number: number, name: name, canSkip: canSkip };\n  steps.push(data);\n  return number;\n}\n\naddStep(C.STEP_BEFORE_PHOTO);\naddStep(C.STEP_BETWEEN_PHOTOS, true);\naddStep(C.STEP_AFTER_PHOTO);\naddStep(C.STEP_COMPARE);\n\nexport const STEPS_CAM = steps;\n\nsteps = [];\naddStep(C.STEP_BEFORE_PHOTO);\naddStep(C.STEP_AFTER_PHOTO);\naddStep(C.STEP_COMPARE);\n\nexport const STEPS_FILE = steps;\n// console.debug(steps);\n\nexport function assertStepInBounds(steps: StepData[], step: number, throwError: boolean = false): boolean {\n  let isInBounds = step >= 0 && step < steps.length;\n  if (throwError && !isInBounds) {\n    throw new Error(`Step is not in bounds: ${step}`);\n  }\n  return isInBounds;\n}\n\nexport function getLastAccessibleStepIndex(steps: StepData[], completedSteps: number) {\n  assertStepInBounds(steps, completedSteps, true);//throw error if not in bounds\n\n  for (let i = completedSteps; i < steps.length; i++) {\n    if (!steps[i].canSkip) {\n      // Return the first following non-skippable step\n      return i;\n    }\n  }\n  return steps.length - 1;\n}\n\nexport function canAccessStep(steps: StepData[], step: number, completedSteps: number): boolean {\n  assertStepInBounds(steps, step, true);\n  assertStepInBounds(steps, completedSteps, true);\n\n  if (step <= completedSteps) {\n    // save time calculating stuff\n    return true;\n  } else {\n    return step <= getLastAccessibleStepIndex(steps, completedSteps);\n  }\n}\n","// Image sources\nexport const SOURCE_WEBCAM = \"SOURCE_WEBCAM\";\nexport const SOURCE_FILE = \"SOURCE_FILE\";\n\n// Image IDs\nexport const AFTER_IMAGE = \"AFTER_IMAGE\";\nexport const BEFORE_IMAGE = \"BEFORE_IMAGE\";\n\n// action types\nexport const SET_SCREEN = \"SET_SCREEN\";\nexport const SET_IMAGE = \"SET_IMAGE\";\nexport const COMPLETE_STEP = \"COMPLETE_STEP\";\nexport const GO_TO_STEP = \"GO_TO_STEP\"\nexport const SET_IMAGE_SOURCE = \"SET_IMAGE_SOURCE\";\nexport const SET_COMPARE_TYPE = \"SET_COMPARE_TYPE\";\nexport const SET_SCREENSHOT_FORMAT = \"SET_SCREENSHOT_FORMAT\";\nexport const SET_PREFERRED_RES = \"SET_PREFERRED_RES\";\nexport const SET_ENABLE_BEFORE_OVERLAY = \"SET_ENABLE_BEFORE_OVERLAY\";\n\n// compare types\nexport const COMPARE_AUTOMATIC = \"COMPARE_AUTOMATIC\";\nexport const COMPARE_SIDE_BY_SIDE = \"COMPARE_SIDE_BY_SIDE\";\nexport const COMPARE_SLIDER_RIGHT_LEFT = \"COMPARE_SLIDER_RIGHT_LEFT\";\nexport const COMPARE_CROSSFADE = \"COMPARE_CROSSFADE\";\n\n//screens\nexport const SCREEN_MENU = \"SCREEN_MENU\";\nexport const SCREEN_STEPS = \"SCREEN_STEPS\";\nexport const SCREEN_SETTINGS = \"SCREEN_SETTINGS\";\nexport const SCREEN_HOW_IT_WORKS = \"SCREEN_HOW_IT_WORKS\";\nexport const SCREEN_PRIVACY = \"SCREEN_PRIVACY\";\n\n//steps\nexport const STEP_BEFORE_PHOTO = \"Before photo\";\nexport const STEP_BETWEEN_PHOTOS = \"Do your thing\";\nexport const STEP_AFTER_PHOTO = \"After photo\";\nexport const STEP_COMPARE = \"Compare photos\";\n","import * as Actions from './actions';\nimport * as C from './constants';\nimport { ReduxState, ImageState, ImageData, Resolution, fallbackState } from './store';\nimport { getLastAccessibleStepIndex, assertStepInBounds, STEPS_CAM, STEPS_FILE } from '../steps/Steps';\n\n\nfunction reducer(state: ReduxState | undefined, action: Actions.Action): ReduxState {\n  if (!state) {\n    console.warn(\"No state was supplied to reducer. Falling back to default values\");\n    state = fallbackState;\n  }\n\n  switch (action.type) {\n    case C.SET_IMAGE: {\n      return handle_setImage(state, action);\n    }\n    case C.COMPLETE_STEP: {\n      return handle_completeStep(state);\n    }\n    case C.GO_TO_STEP: {\n      return handle_goToStep(state, action);\n    }\n    case C.SET_IMAGE_SOURCE: {\n      return handle_setImageSource(state, action);\n    }\n    case C.SET_SCREEN: {\n      const value = action.payload as string;\n      if (value === C.SCREEN_STEPS) {\n        const useCam = state.settings.imageSource === C.SOURCE_WEBCAM;\n        state = {\n          ...state,\n          steps: {\n            ...state.steps,\n            list: useCam ? STEPS_CAM : STEPS_FILE,\n          },\n        }\n      }\n      return {\n        ...state,\n        screen: value,\n      }\n    }\n    case C.SET_COMPARE_TYPE: {\n      const value = action.payload as string;\n      return {\n        ...state,\n        comparisonType: value,\n      }\n    }\n    case C.SET_SCREENSHOT_FORMAT: {\n      const value = action.payload as any;\n      return {\n        ...state,\n        settings: {\n          ...state.settings,\n          screenshotFormat: value,\n        },\n      }\n    }\n    case C.SET_PREFERRED_RES: {\n      const value = action.payload as Resolution;\n      return {\n        ...state,\n        settings: {\n          ...state.settings,\n          preferredResolution: value,\n        },\n      }\n    }\n    case C.SET_ENABLE_BEFORE_OVERLAY: {\n      const value = action.payload as boolean;\n      return {\n        ...state,\n        settings: {\n          ...state.settings,\n          overlayBeforeImage: value,\n        },\n      }\n    }\n    case \"@@INIT\":\n      return state;\n    default:\n      console.warn(`Unknown action type: \"${action.type}\"`);\n      return state;\n  }\n}\n\nfunction handle_completeStep(state: ReduxState): ReduxState {\n  let next = state.steps.current + 1;\n  if (assertStepInBounds(state.steps.list, next)) {\n    let completed = getLastAccessibleStepIndex(state.steps.list, next);\n    // handle cases where the user went back\n    completed = Math.max(state.steps.completed, completed);\n    return {\n      ...state,\n      steps: {\n        ...state.steps,\n        current: next,\n        completed: completed,\n      },\n    }\n  } else {\n    return state;\n  }\n}\n\nfunction handle_setImageSource(state: ReduxState, action: Actions.Action): ReduxState {\n  let value = action.payload as string;\n  return {\n    ...state,\n    settings: {\n      ...state.settings,\n      imageSource: value,\n    },\n  };\n}\n\nfunction handle_goToStep(state: ReduxState, action: Actions.Action): ReduxState {\n  let step = action.payload as number;\n  if (assertStepInBounds(state.steps.list, step) && step <= state.steps.completed) {\n    return {\n      ...state,\n      steps: {\n        ...state.steps,\n        current: step,\n      },\n    };\n  } else {\n    console.warn(`Can not switch to step ${step}. ReduxState: ${state.steps}`);\n    return state;\n  }\n}\n\nfunction handle_setImage(state: ReduxState, action: Actions.Action): ReduxState {\n  let payload = action.payload as Actions.SetImagePayload;\n  let imageStateCopy = { ...state.images };\n  switch (payload.imageName) {\n    case C.AFTER_IMAGE:\n      imageStateCopy.after = modifyImageState(imageStateCopy.after, payload.imageData);\n      break;\n    case C.BEFORE_IMAGE:\n      imageStateCopy.before = modifyImageState(imageStateCopy.before, payload.imageData);\n      debug_print_image_size(payload.imageData);\n      break;\n    default:\n      console.warn(`Unknown image name: \"${payload.imageName}\"`);\n      return state;\n  }\n  // set the image AND go to the next step\n  return handle_completeStep({\n    ...state,\n    images: imageStateCopy,\n  });\n}\n\nfunction debug_print_image_size(src: string) {\n  var img = document.createElement(\"img\");\n  img.onload = function(event) {\n    console.log(`image dimendion: ${img.naturalWidth}x${img.naturalHeight}`);\n  }\n  img.src = src;\n}\n\nfunction modifyImageState(oldSubState: ImageState, newData: ImageData) {\n  return {\n    data: newData,\n    updateCount: oldSubState.updateCount + 1,\n  };\n}\n\nexport default reducer\n","import { createStore } from 'redux';\nimport reducer from './reducer';\nimport * as C from './constants';\nimport { StepData } from '../steps/Steps';\n\nexport type ImageData = string;\n\nexport interface ReduxState {\n  images: {\n    before: ImageState,\n    after: ImageState,\n  },\n  steps: {\n    current: number,\n    completed: number,\n    list: StepData[],\n  },\n  settings: {\n    imageSource: string,\n    screenshotFormat: \"png\" | \"jpeg\" | \"webp\",\n    preferredResolution: Resolution,\n    overlayBeforeImage: boolean,\n  },\n  comparisonType: string,\n  screen: string,\n}\n\nexport interface Resolution {\n  width: number,\n  height: number,\n}\n\nexport interface ImageState {\n  data: ImageData | null,\n  updateCount: number,\n}\n\n\nconst DEFAULT_IMAGE_STATE = {\n  data: null,\n  updateCount: 0,\n};\n\nexport const fallbackState: ReduxState = {\n  images: {\n    before: DEFAULT_IMAGE_STATE,\n    after: DEFAULT_IMAGE_STATE,\n  },\n  steps: {\n    current: 0,\n    completed: 0,\n    list: [],\n  },\n  settings: {\n    imageSource: C.SOURCE_WEBCAM,\n    screenshotFormat: \"png\",\n    preferredResolution: {\n      width: 1920,\n      height: 1080,\n    },\n    overlayBeforeImage: true,\n  },\n  comparisonType: C.COMPARE_SLIDER_RIGHT_LEFT,\n  screen: C.SCREEN_MENU,\n}\n\nlet devTools = undefined;\nif ((window as any).__REDUX_DEVTOOLS_EXTENSION__) {\n  // Redux dev tools are available\n  let devToolOptions = {\n    trace: false,\n    traceLimit: 25\n  };\n  devTools = (window as any).__REDUX_DEVTOOLS_EXTENSION__(devToolOptions);\n}\n\nconst store = createStore(reducer, fallbackState, devTools);\nexport default store;\n","import store, { ImageData, Resolution } from './store';\nimport * as C from './constants';\n\n\n// dispatch\nconst d = store.dispatch;\n\n// actions\nexport interface Action {\n  type: string,\n  payload: string | number | boolean | null | SetImagePayload | Resolution,\n}\n\nexport interface SetImagePayload {\n  imageName: string,\n  imageData: ImageData,\n}\n\n// action creators\nexport function setBeforeImage(imageData: ImageData) {\n  setImage(C.BEFORE_IMAGE, imageData);\n}\n\nexport function setAfterImage(imageData: ImageData) {\n  setImage(C.AFTER_IMAGE, imageData);\n}\n\nexport function setComparisonType(value: string) {\n  d({\n    type: C.SET_COMPARE_TYPE,\n    payload: value,\n  });\n}\n\nfunction setImage(imageName: string, imageData: ImageData) {\n  d({\n    type: C.SET_IMAGE,\n    payload: {\n      imageName: imageName,\n      imageData: imageData,\n    },\n  });\n}\n\nexport function completedCurrentStep() {\n  d({ type: C.COMPLETE_STEP, payload: null });\n}\n\nexport function goToStep(step: number) {\n  d({ type: C.GO_TO_STEP, payload: step });\n}\n\nexport function setImageSource(value: string) {\n  d({ type: C.SET_IMAGE_SOURCE, payload: value });\n}\n\nexport function setScreenshotFormat(value: string) {\n  d({ type: C.SET_SCREENSHOT_FORMAT, payload: value });\n}\n\nexport function setScreen(value: string) {\n  d({ type: C.SET_SCREEN, payload: value });\n}\n\nexport function setPreferredResolution(width: number, height: number) {\n  d({\n    type: C.SET_PREFERRED_RES,\n    payload: {\n      width: width,\n      height: height,\n    },\n  });\n}\n\nexport function setEnableBeforeImageOverlay(value: boolean) {\n  d({ type: C.SET_ENABLE_BEFORE_OVERLAY, payload: value });\n}\n","import React from 'react';\nimport { setScreen } from './redux/actions';\n\nexport default function GoToScreenButton(props: Props) {\n  return <button\n    className=\"button\"\n    onClick={(e: any) => setScreen(props.screen)}>\n    {props.label}\n  </button>\n}\n\ninterface Props {\n  label: string,\n  screen: string,\n}\n","import React from 'react';\nimport * as C from '../redux/constants';\nimport GoToScreenButton from '../GoToScreenButton';\n\nexport default function MainMenu() {\n  return <div className=\"screen-menu\">\n    <GoToScreenButton label=\"Start\" screen={C.SCREEN_STEPS} />\n    <GoToScreenButton label=\"Settings\" screen={C.SCREEN_SETTINGS} />\n    <GoToScreenButton label=\"How it works\" screen={C.SCREEN_HOW_IT_WORKS} />\n    <GoToScreenButton label=\"Privacy policy\" screen={C.SCREEN_PRIVACY} />\n  </div>\n}\n","import React from 'react';\nimport * as C from '../redux/constants';\nimport GoToScreenButton from '../GoToScreenButton';\n\nexport default function Instructions() {\n  return <div className=\"screen-instructions\">\n    <h2>How it works</h2>\n    <p>\n      This web application lets you detect if someone messed with your stuff.\n      It does this by comparing pictures taken before and after you left it unsupervised.\n      Then it highlights any differences it has found.\n      (You could also use it to mess with peoples stuff and make sure that you leave it exactly like they left it. But don't do that: it's evil)\n        </p>\n    <h2>Instructions</h2>\n    <ol>\n      <li>(Optional) Select the settings you want to use</li>\n      <li>Take a image before you leave</li>\n      <li>Keep this website open (or download/save the image)</li>\n      <li>Take an image after you return. By default the image from before will be superimposed over the camera view to help you find the same angle / distance again</li>\n      <li>Compare the two images using the different comparison tools</li>\n    </ol>\n    <GoToScreenButton label=\"Back\" screen={C.SCREEN_MENU} />\n  </div>\n}\n","import React from 'react';\n\nexport default function Setting(props: Props) {\n  const show = props.show === undefined ? true : props.show;\n  if (show) {\n    return <div className=\"setting\">\n      <span className=\"label\">\n        {props.label}\n        {props.hint &&\n          <abbr title={props.hint.text}>\n            {` (${props.hint.trigger})`}\n          </abbr>\n        }\n      </span>\n      {props.children}\n    </div>\n  } else {\n    return null;\n  }\n}\n\ninterface Props {\n  label: string,\n  hint?: {\n    trigger: string,\n    text: string,\n  },\n  children: any,\n  show?: boolean,\n}\n","import React from 'react';\n\nexport default function DropdownChooser(props: Props) {\n  const onChange = (e: any) => props.onValueChange(e.target.value);\n  const options = [...props.optionMap.entries()];\n\n  return <select value={props.value} onChange={onChange}>\n    {options.map(([key, value]) =>\n      <option key={key} value={key}>{value}</option>)\n    }\n  </select>\n}\n\ninterface Props {\n  value: string,\n  onValueChange: (value: string) => void,\n  optionMap: Map<string, string>,//keys -> labels\n}\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { ReduxState } from '../redux/store';\nimport { setImageSource, setScreenshotFormat, setPreferredResolution, setEnableBeforeImageOverlay } from '../redux/actions';\nimport * as C from '../redux/constants';\nimport GoToScreenButton from '../GoToScreenButton';\nimport Setting from '../Setting';\nimport Dropdown from '../Dropdown';\n\nconst SOURCES = new Map<string, string>();\nSOURCES.set(C.SOURCE_WEBCAM, \"Use webcam / camera\");\nSOURCES.set(C.SOURCE_FILE, \"Use local image files\");\n\nconst IMG_FORMAT = new Map<string, string>();\nIMG_FORMAT.set(\"png\", \"PNG\");\nIMG_FORMAT.set(\"jpeg\", \"JPEG\");\nIMG_FORMAT.set(\"webp\", \"WEBP\");\n\nconst IMG_SIZE = new Map<string, string>();\nIMG_SIZE.set(\"640x480\", \"480p\");\nIMG_SIZE.set(\"1280x720\", \"720p (HD)\");\nIMG_SIZE.set(\"1920x1080\", \"1080p (Full HD)\");\nIMG_SIZE.set(\"3840x2160\", \"2160p (4K UHD)\");\n\n\ninterface Props {\n  imageSource: string,\n  screenshotFormat: string,\n  preferredResolution: string,\n  isBeforeOverlayEnabled: boolean,\n}\n\nclass SettingsView extends React.Component<Props> {\n  render() {\n    const showWebcamSettings = this.props.imageSource === C.SOURCE_WEBCAM;\n    return (\n      <div className=\"screen-settings\">\n        <h1>Settings</h1>\n\n        <Setting label=\"Image source\">\n          <Dropdown\n            optionMap={SOURCES}\n            value={this.props.imageSource}\n            onValueChange={setImageSource} />\n        </Setting>\n\n        <Setting label=\"Photo format\"\n          show={showWebcamSettings}>\n          <Dropdown\n            optionMap={IMG_FORMAT}\n            value={this.props.screenshotFormat}\n            onValueChange={setScreenshotFormat} />\n        </Setting>\n\n        <Setting label=\"Resolution\"\n          hint={{\n            trigger: \"*\",\n            text: \"The browser will request this resolution, but depending on your hardware the actual resolution may differ\"\n          }}\n          show={showWebcamSettings}>\n          <Dropdown\n            optionMap={IMG_SIZE}\n            value={this.props.preferredResolution}\n            onValueChange={this.onResolutionChange} />\n        </Setting>\n\n        <Setting label=\"Image overlay\"\n          hint={{\n            trigger: \"?\",\n            text: \"Enabling this option will overlay the image you took before on the camera view, so that you can find the alignment and position that you used before\"\n          }}\n          show={showWebcamSettings}>\n          <label>\n            <input\n              type=\"checkbox\"\n              checked={this.props.isBeforeOverlayEnabled}\n              onChange={(e: any) => setEnableBeforeImageOverlay(!this.props.isBeforeOverlayEnabled)}\n            />\n            {\"help you find the same perspective again\"}\n          </label>\n        </Setting>\n        <GoToScreenButton label=\"Back\" screen={C.SCREEN_MENU} />\n      </div>\n    );\n  }\n\n  onResolutionChange(resString: string) {\n    try {\n      const res = resString.split(\"x\", 2);\n      const w = Number(res[0]);\n      const h = Number(res[1]);\n      setPreferredResolution(w, h);\n    } catch (e) {\n      console.error(`Can not parse resolution: \"${resString}\"`, e)\n    }\n  }\n}\n\nconst mapStateToProps = (state: ReduxState, ownProps: any) => {\n  const res = state.settings.preferredResolution;\n  return {\n    ...ownProps,\n    imageSource: state.settings.imageSource,\n    screenshotFormat: state.settings.screenshotFormat,\n    preferredResolution: `${res.width}x${res.height}`,\n    isBeforeOverlayEnabled: state.settings.overlayBeforeImage,\n  };\n};\nexport default connect(mapStateToProps)(SettingsView);\n","import React from 'react';\nimport * as C from '../redux/constants';\nimport GoToScreenButton from '../GoToScreenButton';\n\nexport default function PrivacyPolicy() {\n  return <div className=\"screen-privacy\">\n    <h1>Privacy policy</h1>\n    <p>\n      <span className=\"bold\">I do not collect any information about you. </span>\n      This app is designed to work locally and to never send any data to any servers.\n      That means that any photos that you take or \"upload\" will never leave your browser.\n      I also do not use local data storage (like cookies), which means that all\n      data will be lost when you leave or reload the website.\n    </p>\n    <h2>Third party libraries</h2>\n    <p>\n      To realize this website (without spending years developing it) I use some\n      third party libraries.\n      They handle tasks like accessing the camera / webcam\n      and managing the state of the application.\n      As far as I can tell none of them send any data back home.\n    </p>\n    <h2>Hosting provider</h2>\n    <p>\n      GitHub Pages is used to host this web application.\n      Their <a href=\"https://docs.github.com/en/github/site-policy/github-privacy-statement#github-pages\">\n        privacy policy\n      </a>\n      <abbr title=\"Last checked on July 10, 2020\">*</abbr> states:\n      <blockquote className=\"ludwig\">\n        Please note that GitHub may collect User Personal Information from\n        visitors to your GitHub Pages website, including logs of visitor IP addresses,\n        to comply with legal obligations, and to maintain the security and\n        integrity of the Website and the Service.\n      </blockquote>\n    </p>\n    <h2>Contact</h2>\n    <span>\n      If you notice any errors in this document or any activity that is not\n      in line with this policy, please send an email with your findings to\n      <a href=\"mailto:info@six-two.dev\"> info@six-two.dev</a>\n    </span>\n    <br />\n    <GoToScreenButton label=\"Back\" screen={C.SCREEN_MENU} />\n  </div >\n}\n","import React from 'react';\n\nexport function ErrorMessage(props: Props) {\n  if (props.log !== false) { //accept true and undefined\n    console.warn(\"[ErrorMessage]\", props.message);\n  }\n  return <div className=\"err-msg\">\n    {props.message}\n  </div>\n}\n\nexport function BugMessage(props: Props) {\n  if (props.log !== false){ //accept true and undefined\n    console.warn(\"[BugMessage]\", props.message);\n  }\n  return <div className=\"err-msg\">\n    <div className=\"bold\">\n      Ooops, this should not happen. You have probably found a bug!\n    </div>\n    {props.message}\n  </div>\n}\n\ninterface Props {\n  message: string,\n  log?: boolean,\n}\n","import React from 'react';\n\nfunction detectImageFormat(imageDataUrl: string) {\n  try {\n    // looks like \"data:image/png;base64,isGZ7F...\"\n    const match = imageDataUrl.match(/^data:image\\/([a-zA-Z]+)/);\n    if (match) {\n      const format = match[0].split(\"/\")[1];\n      console.debug(\"Auto detect image format:\", format);\n      return format;\n    }\n  } catch (e) {\n    console.error(\"Internal error in detectImageFormat\", e);\n  }\n  console.warn(`Auto detect format failed. Data url looks like \"${imageDataUrl.slice(0, 100)}\" (cut off after 100 characters)`);\n  return \"unknown.png\";//just guess, signal unknown to user\n}\n\nexport default function DownloadImageButton(props: Props) {\n  if (!props.imageData) {\n    return null;\n  }\n\n  let fileName = props.fileName;\n  if (props.autoDetectFormat === undefined || props.autoDetectFormat === true) {\n    fileName += \".\" + detectImageFormat(props.imageData);\n  }\n\n  return <a className=\"button\"\n    href={props.imageData}\n    download={fileName}>\n    {props.buttonText}\n  </a>\n}\n\ninterface Props {\n  imageData?: string | null,\n  fileName: string,\n  buttonText: string,\n  autoDetectFormat?: boolean,\n}\n","import React from 'react';\nimport DownloadImageButton from '../DownloadImageButton';\n\n\ninterface Props {\n  beforeImage: string | null,\n}\n\nexport default function BetweenStepView(props: Props) {\n  if (!props.beforeImage) {\n    return <div>Before image not found: please go back to the previous step</div>\n  }\n  return <div className=\"step-between\">\n    <h2>Do your thing</h2>\n      Below is the image you have taken. If it is looking ok, you can go and do your stuff.\n      <span className=\"important-hint\"> DO NOT close or reload this tab, or the image will be lost! </span>\n      When you return go to the next step.\n      <br />\n      If you want to make sure you don't loose it click the <code>Download image</code> button below.\n      If you do not like the image, go back to the previous step and take another image.\n\n      <img src={props.beforeImage} alt=\"\" />\n\n    <DownloadImageButton\n      buttonText=\"Download image\"\n      fileName={`webcam-image`}\n      imageData={props.beforeImage} />\n  </div>\n}\n","import React from 'react';\nimport { compare } from 'resemblejs';\nimport { ImageData } from '../redux/store';\nimport DownloadImageButton from '../DownloadImageButton';\nimport { ErrorMessage } from '../ErrorMessage';\n\n\ninterface Props {\n  beforeImage: ImageData,\n  afterImage: ImageData,\n}\n\ninterface State {\n  diffImage: ImageData | null,\n  errorMessage: string | null,\n}\n\nexport default class AutomaticCompare extends React.Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      diffImage: null,\n      errorMessage: null,\n    };\n  }\n\n  render() {\n    if (this.state.errorMessage) {\n      return <ErrorMessage message={this.state.errorMessage} />\n    }\n\n    if (this.state.diffImage) {\n      return <div className=\"diff-view\">\n        <div className=\"instructions\">\n          Differences between the images are marked in pink.\n          If almost everything is maked pink, choose a different method to do a manual comparison.\n        </div>\n        <img src={this.state.diffImage} alt=\"\" />\n        <DownloadImageButton\n          buttonText=\"Download comparison image\"\n          fileName=\"before-after-compare\"\n          imageData={this.state.diffImage} />\n      </div>\n    } else {\n      this.calculateDiffImage();\n      return <div>Comparing images...</div>\n    }\n  }\n\n  calculateDiffImage() {\n    const after = this.props.afterImage;\n    const before = this.props.beforeImage;\n    if (after && before) {\n      const options = {\n        output: {\n          errorType: \"movementDifferenceIntensity\",\n          largeImageThreshold: 1500,\n          useCrossOrigin: false,\n          outputDiff: true\n        },\n        scaleToSameSize: true,\n        ignore: \"colors\",\n      };\n      compare(before, after, options, this.resembleCallback);\n    } else {\n      this.setState({\n        errorMessage: \"Before or after image is empty or undefined\",\n      });\n    }\n  }\n\n  resembleCallback = (error: any, data: any) => {\n    if (error) {\n      console.error(\"An error occured while comparing the images: \", error);\n      this.setState({\n        errorMessage: `An error occured while comparing the images: ${error}`\n      });\n    } else {\n      const imageData: string = data.getImageDataUrl();\n      this.setState({\n        diffImage: imageData\n      });\n    }\n  }\n}\n","import React from 'react';\nimport ReactCompareImage from 'react-compare-image';\n\nexport default function LeftRightSlider(props: Props) {\n  return <div className=\"image-diff left-right-slider\">\n    <div className=\"instructions\">\n      Move the slider around to compare the images.\n    </div>\n    <ReactCompareImage\n      leftImage={props.beforeImage}\n      leftImageLabel=\"Before\"\n      rightImage={props.afterImage}\n      rightImageLabel=\"After\"\n      sliderLineColor=\"red\"\n      handle={<React.Fragment />}\n    />\n  </div>\n}\n\ninterface Props {\n  beforeImage: string,\n  afterImage: string,\n}\n","import React from \"react\";\nimport Slider from 'rc-slider';\nimport 'rc-slider/assets/index.css';\n\nconst MySlider = Slider as any;\n\nexport default class CrossfadeCompare extends React.Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      sliderValue: 50,\n    };\n  }\n\n  render() {\n    return <div className=\"img-diff crossfade\">\n      <div className=\"instructions\">\n        Move the slider around to compare the images.\n      </div>\n      <div className=\"slider-div\">\n        <span>Before</span>\n        <MySlider\n          min={0}\n          max={100}\n          value={this.state.sliderValue}\n          onChange={this.onOpacityChange}\n        />\n        <span>After</span>\n      </div>\n      <div className=\"overlay-container\">\n        <img src={this.props.beforeImage} alt=\"\" />\n        <img className=\"on-top\" src={this.props.afterImage} alt=\"\"\n          style={{ opacity: this.state.sliderValue / 100 }} />\n      </div>\n    </div>\n  }\n\n  onOpacityChange = (value: number) => {\n    if (value !== this.state.sliderValue) {\n      this.setState({ sliderValue: value })\n    }\n  }\n}\n\ninterface Props {\n  beforeImage: string,\n  afterImage: string,\n}\n\ninterface State {\n  sliderValue: number,\n}\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { ReduxState, ImageData } from '../redux/store';\nimport { setComparisonType } from '../redux/actions';\nimport * as C from '../redux/constants';\nimport AutomaticCompare from '../compare-images/AutomaticCompare';\nimport LeftRightSlider from '../compare-images/LeftRightSlider';\nimport CrossfadeCompare from '../compare-images/CrossfadeCompare';\nimport Dropdown from '../Dropdown';\nimport { BugMessage } from '../ErrorMessage';\n\nconst TYPES = new Map<string, string>();\nTYPES.set(C.COMPARE_AUTOMATIC, \"Automatic\");\nTYPES.set(C.COMPARE_SLIDER_RIGHT_LEFT, \"Slider: Right - Left\");\nTYPES.set(C.COMPARE_CROSSFADE, \"Crossfade\");\n// TYPES.set(C.COMPARE_SIDE_BY_SIDE, \"Side by side\");\n\n\ninterface Props {\n  beforeImage: ImageData | null,\n  afterImage: ImageData | null,\n  type: string,\n}\n\nclass ImageCompareView extends React.Component<Props> {\n  render() {\n    return <div className=\"diff-view\">\n      <div className=\"type-chooser\">\n        <span>Comparison method: </span>\n        <Dropdown\n          optionMap={TYPES}\n          value={this.props.type}\n          onValueChange={(x) => setComparisonType(x)} />\n      </div>\n      {this.renderContents()}\n    </div>\n  }\n\n  renderContents() {\n    const before = this.props.beforeImage;\n    if (!before) {\n      return <BugMessage message=\"Before image is missing\" />\n    }\n    const after = this.props.afterImage;\n    if (!after) {\n      return <BugMessage message=\"After image is missing\" />\n    }\n    switch (this.props.type) {\n      case C.COMPARE_AUTOMATIC:\n        return <AutomaticCompare beforeImage={before} afterImage={after} />\n      case C.COMPARE_CROSSFADE:\n        return <CrossfadeCompare beforeImage={before} afterImage={after} />\n      case C.COMPARE_SLIDER_RIGHT_LEFT:\n        return <LeftRightSlider beforeImage={before} afterImage={after} />\n      default:\n        return <BugMessage message={`Unknown compare type: ${this.props.type}`} />\n    }\n  }\n}\n\nconst mapStateToProps = (state: ReduxState, ownProps: any) => {\n  return {\n    ...ownProps,\n    beforeImage: state.images.before.data,\n    afterImage: state.images.after.data,\n    type: state.comparisonType,\n  };\n};\n\nexport default connect(mapStateToProps)(ImageCompareView);\n","import React from 'react';\nimport Webcam from \"react-webcam\";\nimport store, { ImageData } from './redux/store';\n\ninterface Props {\n  backgroundImage?: ImageData,\n  onPhoto: (image: ImageData) => void,\n}\n\nclass TakeImageView extends React.Component<Props> {\n  webcamRef: React.RefObject<any>;\n\n  constructor(props: Props) {\n    super(props);\n    this.webcamRef = React.createRef();\n  }\n\n  render() {\n    const bgImg = this.props.backgroundImage;\n    const className = \"take-image-div\" + (bgImg ? \" transparent-cam\" : \"\");\n    const screenshotFormat = store.getState().settings.screenshotFormat;\n    const resolution = store.getState().settings.preferredResolution;\n    const VIDEO_CONSTRAINTS = {\n      facingMode: { ideal: \"environment\" },\n      width: { ideal: resolution.width },\n      height: { ideal: resolution.height },\n    };\n\n    return <div className={className}>\n      <Webcam ref={this.webcamRef} className=\"cam\" onClick={this.onClick}\n        audio={false} videoConstraints={VIDEO_CONSTRAINTS}\n        forceScreenshotSourceSize={true}\n        screenshotFormat={`image/${screenshotFormat}` as any} />\n      {bgImg ? <img src={bgImg} alt=\"\" onClick={this.onClick} /> : null}\n    </div>\n  }\n\n  onClick = (event: any) => {\n    let photo = this.webcamRef.current.getScreenshot();\n    if (photo) {\n      this.props.onPhoto(photo);\n    }\n  }\n}\n\nexport default TakeImageView;\n","import React from 'react';\n\nexport default function ImageUploadButton(props: Props) {\n  return <label className=\"button file-select\">\n    <input\n      type='file'\n      onChange={fileSelectionHandler(props)} />\n    {props.label}\n  </label>\n}\n\ninterface Props {\n  label: string,\n  onSuccess: (imageDataUrl: string) => void,\n  onError: () => void,\n}\n\nfunction fileSelectionHandler(props: Props) {\n  return (selectEvent: any) => {\n    const files = selectEvent.target.files;\n    if (files && files[0]) {\n      var fileReader = new FileReader();\n      // called when the image file is loaded\n      fileReader.onload = (loadEvent: any) => {\n        const imgData = loadEvent.target.result;\n        const img = document.createElement(\"img\");\n        img.onload = () => props.onSuccess(imgData);\n        img.onerror = props.onError\n        img.src = imgData;\n      }\n      fileReader.readAsDataURL(files[0]);\n    }\n    // clear the input\n    // SEE https://stackoverflow.com/questions/42192346/how-to-reset-reactjs-file-input\n    selectEvent.target.value = null;\n  }\n}\n","import React from 'react';\nimport { ErrorMessage } from './ErrorMessage';\nimport ImageUploadButton from './ImageUploadButton';\n\ninterface Props {\n  image: string | null,\n  setImage: (imageDataUrl: string) => void,\n}\n\ninterface State {\n  hasError: boolean,\n}\n\nclass ImageUrlUploader extends React.Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      hasError: false,\n    }\n  }\n\n  render() {\n    if (this.props.image) {\n      return <div className=\"image-upload\">\n        <img src={this.props.image} alt=\"\" />\n        {this.renderFileInputButton(\"Use a different image\")}\n      </div>\n    } else {\n      return <div className=\"image-upload\">\n        {this.state.hasError &&\n          <ErrorMessage message=\"The file you uploaded can is not a valid image. Please try again.\" />\n        }\n        {this.renderFileInputButton(\"Select image\")}\n      </div>\n    }\n  }\n\n  renderFileInputButton(text: string) {\n    return <ImageUploadButton\n      onSuccess={this.props.setImage}\n      onError={this.onError}\n      label={text}\n    />\n  }\n\n  onError = () => {\n    this.setState({\n      hasError: true,\n    });\n  }\n}\n\nexport default ImageUrlUploader;\n","import React from 'react';\nimport store, { ImageData } from '../redux/store';\nimport { SOURCE_WEBCAM, SOURCE_FILE } from '../redux/constants';\nimport TakeImageView from '../TakeImageView';\nimport ImageUpload from '../ImageUpload';\nimport { BugMessage } from '../ErrorMessage';\nimport DownloadImageButton from '../DownloadImageButton';\n\nconst CLASS_NAME = \"step-get-image\";\n\ninterface Props {\n  currentImage: string | null,\n  onImage: (image: ImageData) => void,\n  backgroundImage?: ImageData,\n}\n\nfunction GetImageView(props: Props) {\n  const imageSource = store.getState().settings.imageSource;\n  switch (imageSource) {\n    case SOURCE_WEBCAM:\n      return TakePhotoView(props);\n    case SOURCE_FILE:\n      return UploadImageView(props);\n    default:\n      return <BugMessage message={`Unknown image source: \"${imageSource}\"`} />\n  }\n}\n\nfunction TakePhotoView(props: Props) {\n  return <div className={CLASS_NAME}>\n    <h2>Take a photo</h2>\n    <div className=\"instructions\">\n      First allow this website access to your camera. Then touch/click the image below to take a photo.\n    </div>\n    <TakeImageView\n      onPhoto={props.onImage}\n      backgroundImage={props.backgroundImage} />\n\n    <DownloadImageButton\n      buttonText=\"Download last image taken\"\n      fileName={`webcam-image`}\n      imageData={props.currentImage} />\n  </div>\n}\n\nfunction UploadImageView(props: Props) {\n  return <div className={CLASS_NAME}>\n    <h2>Select an image</h2>\n    <ImageUpload\n      image={props.currentImage}\n      setImage={props.onImage} />\n  </div>\n}\n\nexport default GetImageView;\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { ReduxState } from './redux/store';\nimport { goToStep } from './redux/actions';\nimport { StepData } from './steps/Steps';\n\n\ninterface Props {\n  lastSelectableStep: number,\n  currentStep: number,\n  stepList: StepData[],\n}\n\nclass StepListView extends React.Component<Props> {\n  render() {\n    const step = this.props.currentStep;\n    return <div className=\"step-header\">\n      <ul className=\"list\">\n        {this.props.stepList.map(this.renderStep)}\n      </ul>\n      <div className=\"buttons\">\n        {this.goToStepButton(\"Previous\", step - 1)}\n        {this.goToStepButton(\"Next\", step + 1)}\n      </div>\n    </div>\n  }\n\n  renderStep = (step: StepData) => {\n    let classes = [\"step\"];\n    let onClick;\n    if (step.number <= this.props.lastSelectableStep) {\n      if (step.number === this.props.currentStep) {\n        classes.push(\"selected\");\n      } else {\n        classes.push(\"selectable\");\n        onClick = () => goToStep(step.number);\n      }\n    } else {\n      classes.push(\"disabled\");\n    }\n    return <li className={classes.join(\" \")} key={step.number} onClick={onClick}>\n      {step.name}\n    </li>;\n  }\n\n  goToStepButton(text: string, step: number) {\n    const canGoThere = Boolean(0 <= step && step <= this.props.lastSelectableStep);\n    const className = canGoThere ? undefined : \"disabled\";\n    return <button className={className} onClick={(e: any) => goToStep(step)}>\n      {text}\n    </button>\n  }\n}\n\n\nconst mapStateToProps = (state: ReduxState, ownProps: any) => {\n  return {\n    ...ownProps,\n    lastSelectableStep: state.steps.completed,\n    currentStep: state.steps.current,\n    stepList: state.steps.list,\n  };\n};\nexport default connect(mapStateToProps)(StepListView);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { ReduxState, ImageData } from '../redux/store';\nimport { goToStep, setBeforeImage, setAfterImage } from '../redux/actions';\nimport * as C from '../redux/constants';\nimport { BugMessage } from '../ErrorMessage';\nimport { StepData } from '../steps/Steps';\nimport BetweenPhotosView from '../steps/BetweenStep';\nimport ImageCompareView from '../steps/ImageCompareView';\nimport GetImageView from '../steps/GetImage';\nimport StepListView from '../StepListView';\n\n\ninterface Props {\n  beforeImageData: ImageData | null,\n  afterImageData: ImageData | null,\n  step: number,\n  overlayBeforeImage: boolean,\n  stepList: StepData[],\n}\n\ninterface State {\n}\n\nclass StepContentView extends React.Component<Props, State> {\n  render() {\n    return <div>\n      <StepListView />\n      <div className=\"step-content\">\n        {this.renderContents()}\n      </div>\n      {this.renderNextButtonIfPossible()}\n    </div>\n  }\n\n  renderContents() {\n    const step = this.props.stepList[this.props.step].name;\n    switch (step) {\n      case C.STEP_BEFORE_PHOTO:\n        return <GetImageView\n          onImage={setBeforeImage}\n          currentImage={this.props.beforeImageData} />\n      case C.STEP_BETWEEN_PHOTOS:\n        return <BetweenPhotosView beforeImage={this.props.beforeImageData} />\n      case C.STEP_AFTER_PHOTO: {\n        const bgImg = (this.props.overlayBeforeImage && this.props.beforeImageData) || undefined;\n        return <GetImageView\n          onImage={setAfterImage}\n          currentImage={this.props.afterImageData}\n          backgroundImage={bgImg} />\n      }\n      case C.STEP_COMPARE:\n        return <ImageCompareView />\n      default:\n        return <BugMessage message={`Unknown step: \"${step}\"`} />\n    }\n  }\n\n  renderNextButtonIfPossible() {\n    const steps = this.props.stepList;\n    const step = steps[this.props.step];\n    if (step.canSkip) { // only show on skippable steps\n      const nextStep = this.props.step + 1;\n      if (nextStep < steps.length) { // do not show on last step\n        const goToNextStep = (e: any) => goToStep(nextStep);\n        return <button className=\"button\" onClick={goToNextStep}>\n          {\"Next step\"}\n        </button>\n      }\n    }\n    return null;\n  }\n}\n\n\nconst mapStateToProps = (state: ReduxState, ownProps: any) => {\n  return {\n    ...ownProps,\n    beforeImageData: state.images.before.data,\n    afterImageData: state.images.after.data,\n    overlayBeforeImage: state.settings.overlayBeforeImage,\n    step: state.steps.current,\n    stepList: state.steps.list,\n  };\n};\n\nexport default connect(mapStateToProps)(StepContentView);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { ReduxState } from './redux/store';\nimport * as C from './redux/constants';\nimport MainMenu from './screens/MainMenu';\nimport Instructions from './screens/Instructions';\nimport Settings from './screens/Settings';\nimport Privacy from './screens/Privacy';\nimport StepContent from './screens/Steps';\nimport { BugMessage } from './ErrorMessage';\n\n\nfunction ScreenManager(props: Props) {\n  switch (props.screen) {\n    case C.SCREEN_MENU:\n      return <MainMenu />\n    case C.SCREEN_STEPS:\n      return <StepContent />\n    case C.SCREEN_SETTINGS:\n      return <Settings />\n    case C.SCREEN_HOW_IT_WORKS:\n      return <Instructions />\n    case C.SCREEN_PRIVACY:\n      return <Privacy />\n    default:\n      return <BugMessage message={`Unknown screen: \"${props.screen}\"`} />\n  }\n}\n\ninterface Props {\n  screen: string,\n}\n\nconst mapStateToProps = (state: ReduxState, ownProps: any) => {\n  return {\n    ...ownProps,\n    screen: state.screen,\n  };\n};\nexport default connect(mapStateToProps)(ScreenManager);\n","import React from 'react';\nimport ScreenManager from './ScreenManager';\nimport '../css/main.scss';\n\n// --------------------------- TODOs -------------------------------\n// improve instructions\n// why is it so slow on my smartphone? are 3 ~20MB pictures so hard to handle? :p\n// [WIP] Make it look ok on a smartphone\n// [opt] add settings persistence: local storage, url?\n//  -> maybe add an url parameter + chooser pattern so it can be saved\n// [opt] More / custom resolutions?\n// [opt] Better automatic comparison\n// -----------------------------------------------------------------\n\nexport default function App() {\n  return <div className=\"app\">\n    <ScreenManager />\n  </div>\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux'\nimport App from './app/App';\nimport * as serviceWorker from './serviceWorker';\nimport store from './app/redux/store';\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\n// const isLocalhost = Boolean(\n//   window.location.hostname === 'localhost' ||\n//     // [::1] is the IPv6 localhost address.\n//     window.location.hostname === '[::1]' ||\n//     // 127.0.0.0/8 are considered localhost for IPv4.\n//     window.location.hostname.match(\n//       /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n//     )\n// );\n//\n// export function register(config: any) {\n//   if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n//     // The URL constructor is available in all browsers that support SW.\n//     const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n//     if (publicUrl.origin !== window.location.origin) {\n//       // Our service worker won't work if PUBLIC_URL is on a different origin\n//       // from what our page is served on. This might happen if a CDN is used to\n//       // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n//       return;\n//     }\n//\n//     window.addEventListener('load', () => {\n//       const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n//\n//       if (isLocalhost) {\n//         // This is running on localhost. Let's check if a service worker still exists or not.\n//         checkValidServiceWorker(swUrl, config);\n//\n//         // Add some additional logging to localhost, pointing developers to the\n//         // service worker/PWA documentation.\n//         navigator.serviceWorker.ready.then(() => {\n//           console.log(\n//             'This web app is being served cache-first by a service ' +\n//               'worker. To learn more, visit https://bit.ly/CRA-PWA'\n//           );\n//         });\n//       } else {\n//         // Is not localhost. Just register service worker\n//         registerValidSW(swUrl, config);\n//       }\n//     });\n//   }\n// }\n//\n// function registerValidSW(swUrl, config) {\n//   navigator.serviceWorker\n//     .register(swUrl)\n//     .then(registration => {\n//       registration.onupdatefound = () => {\n//         const installingWorker = registration.installing;\n//         if (installingWorker == null) {\n//           return;\n//         }\n//         installingWorker.onstatechange = () => {\n//           if (installingWorker.state === 'installed') {\n//             if (navigator.serviceWorker.controller) {\n//               // At this point, the updated precached content has been fetched,\n//               // but the previous service worker will still serve the older\n//               // content until all client tabs are closed.\n//               console.log(\n//                 'New content is available and will be used when all ' +\n//                   'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n//               );\n//\n//               // Execute callback\n//               if (config && config.onUpdate) {\n//                 config.onUpdate(registration);\n//               }\n//             } else {\n//               // At this point, everything has been precached.\n//               // It's the perfect time to display a\n//               // \"Content is cached for offline use.\" message.\n//               console.log('Content is cached for offline use.');\n//\n//               // Execute callback\n//               if (config && config.onSuccess) {\n//                 config.onSuccess(registration);\n//               }\n//             }\n//           }\n//         };\n//       };\n//     })\n//     .catch(error => {\n//       console.error('Error during service worker registration:', error);\n//     });\n// }\n//\n// function checkValidServiceWorker(swUrl, config) {\n//   // Check if the service worker can be found. If it can't reload the page.\n//   fetch(swUrl, {\n//     headers: { 'Service-Worker': 'script' },\n//   })\n//     .then(response => {\n//       // Ensure service worker exists, and that we really are getting a JS file.\n//       const contentType = response.headers.get('content-type');\n//       if (\n//         response.status === 404 ||\n//         (contentType != null && contentType.indexOf('javascript') === -1)\n//       ) {\n//         // No service worker found. Probably a different app. Reload the page.\n//         navigator.serviceWorker.ready.then(registration => {\n//           registration.unregister().then(() => {\n//             window.location.reload();\n//           });\n//         });\n//       } else {\n//         // Service worker found. Proceed as normal.\n//         registerValidSW(swUrl, config);\n//       }\n//     })\n//     .catch(() => {\n//       console.log(\n//         'No internet connection found. App is running in offline mode.'\n//       );\n//     });\n// }\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n"],"sourceRoot":""}