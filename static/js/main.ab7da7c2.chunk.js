(this.webpackJsonpreact_did_someone_touch_this=this.webpackJsonpreact_did_someone_touch_this||[]).push([[0],{27:function(e,t,a){e.exports=a(47)},46:function(e,t,a){},47:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(7),s=a.n(o),c=a(8),i=a(1),l=a(13),u=[];function m(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=u.length,n={number:a,name:e,canSkip:t};return u.push(n),a}var p=m("Intro",!0),g=m("Settings",!0),f=m("Before photo"),h=m("Do your thing",!0),d=m("After photo"),b=m("Compare photos"),E=u;function v(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=e>=0&&e<E.length;if(t&&!a)throw new Error("Step is not in bounds: ".concat(e));return a}function O(e){v(e,!0);for(var t=e;t<E.length;t++)if(!E[t].canSkip)return t;return E.length-1}function y(e){var t=e.steps.current+1;if(v(t)){var a=O(t);return a=Math.max(e.steps.completed,a),Object(i.a)(Object(i.a)({},e),{},{steps:{current:t,completed:a}})}return e}function w(e,t){return{data:t,updateCount:e.updateCount+1}}var I=function(e,t){switch(e||(console.warn("No state was supplied to reducer. Falling back to default values"),e=S),t.type){case"SET_IMAGE":return function(e,t){var a=t.payload,n=Object(i.a)({},e.images);switch(a.imageName){case"AFTER_IMAGE":n.after=w(n.after,a.imageData);break;case"BEFORE_IMAGE":n.before=w(n.before,a.imageData),function(e){var t=document.createElement("img");t.onload=function(e){console.log("image dimendion: ".concat(t.naturalWidth,"x").concat(t.naturalHeight))},t.src=e}(a.imageData);break;default:return console.warn('Unknown image name: "'.concat(a.imageName,'"')),e}return y(Object(i.a)(Object(i.a)({},e),{},{images:n}))}(e,t);case"COMPLETE_STEP":return y(e);case"GO_TO_STEP":return function(e,t){var a=t.payload;return v(a)&&a<=e.steps.completed?Object(i.a)(Object(i.a)({},e),{},{steps:Object(i.a)(Object(i.a)({},e.steps),{},{current:a})}):(console.warn("Can not switch to step ".concat(a,". ReduxState: ").concat(e.steps)),e)}(e,t);case"SET_IMAGE_SOURCE":return function(e,t){var a=t.payload;return Object(i.a)(Object(i.a)({},e),{},{settings:Object(i.a)(Object(i.a)({},e.settings),{},{imageSource:a})})}(e,t);case"SET_COMPARE_TYPE":var a=t.payload;return Object(i.a)(Object(i.a)({},e),{},{comparisonType:a});case"SET_SCREENSHOT_FORMAT":var n=t.payload;return Object(i.a)(Object(i.a)({},e),{},{settings:Object(i.a)(Object(i.a)({},e.settings),{},{screenshotFormat:n})});case"SET_PREFERRED_RES":var r=t.payload;return Object(i.a)(Object(i.a)({},e),{},{settings:Object(i.a)(Object(i.a)({},e.settings),{},{preferredResolution:r})});case"SET_ENABLE_BEFORE_OVERLAY":var o=t.payload;return Object(i.a)(Object(i.a)({},e),{},{settings:Object(i.a)(Object(i.a)({},e.settings),{},{overlayBeforeImage:o})});case"@@INIT":return e;default:return console.warn('Unknown action type: "'.concat(t.type,'"')),e}},j={data:null,updateCount:0},S={images:{before:j,after:j},steps:{current:-1,completed:O(0)},settings:{imageSource:"Use webcam",screenshotFormat:"png",preferredResolution:{width:1920,height:1080},overlayBeforeImage:!0},comparisonType:"COMPARE_AUTOMATIC"},k=void 0;if(window.__REDUX_DEVTOOLS_EXTENSION__){k=window.__REDUX_DEVTOOLS_EXTENSION__({trace:!1,traceLimit:25})}var C=Object(l.b)(I,S,k),_=C.dispatch;function T(e){N("BEFORE_IMAGE",e)}function R(e){N("AFTER_IMAGE",e)}function N(e,t){_({type:"SET_IMAGE",payload:{imageName:e,imageData:t}})}function A(e){_({type:"GO_TO_STEP",payload:e})}function D(e){_({type:"SET_IMAGE_SOURCE",payload:e})}function M(e){_({type:"SET_SCREENSHOT_FORMAT",payload:e})}function B(){return r.a.createElement("div",null,r.a.createElement(F,{label:"Start",step:f}),r.a.createElement(F,{label:"Settings",step:g}),r.a.createElement(F,{label:"How it works",step:p}))}function F(e){return r.a.createElement("button",{className:"button",onClick:function(t){return A(e.step)}},e.label)}var x=a(3),P=a(4),U=a(6),L=a(5),G=function(e){Object(U.a)(a,e);var t=Object(L.a)(a);function a(){var e;Object(x.a)(this,a);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).renderStep=function(t){var a,n=["step"];return t.number<=e.props.lastSelectableStep?t.number===e.props.currentStep?n.push("selected"):(n.push("selectable"),a=function(){return A(t.number)}):n.push("disabled"),r.a.createElement("li",{className:n.join(" "),key:t.number,onClick:a},t.name)},e}return Object(P.a)(a,[{key:"render",value:function(){var e=this.props.currentStep;return r.a.createElement("div",{className:"step-header"},r.a.createElement("ul",{className:"list"},E.map(this.renderStep)),r.a.createElement("div",{className:"buttons"},this.goToStepButton("Previous",e-1),this.goToStepButton("Next",e+1)))}},{key:"goToStepButton",value:function(e,t){var a=Boolean(0<=t&&t<=this.props.lastSelectableStep)?void 0:"disabled";return r.a.createElement("button",{className:a,onClick:function(e){return A(t)}},e)}}]),a}(r.a.Component),V=Object(c.b)((function(e,t){return Object(i.a)(Object(i.a)({},t),{},{lastSelectableStep:e.steps.completed,currentStep:e.steps.current})}))(G),H=a(19);function Y(e){if(!e.imageData)return null;var t=e.fileName;return void 0!==e.autoDetectFormat&&!0!==e.autoDetectFormat||(t+="."+function(e){try{var t=e.match(/^data:image\/([a-zA-Z]+)/);if(t){var a=t[0].split("/")[1];return console.debug("Auto detect image format:",a),a}}catch(n){console.error("Internal error in detectImageFormat",n)}return console.warn('Auto detect format failed. Data url looks like "'.concat(e.slice(0,100),'" (cut off after 100 characters)')),"unknown.png"}(e.imageData)),r.a.createElement("a",{className:"download-button",href:e.imageData,download:t},e.buttonText)}var W=function(e){Object(U.a)(a,e);var t=Object(L.a)(a);function a(e){var n;return Object(x.a)(this,a),(n=t.call(this,e)).resembleCallback=function(e,t){if(e)console.error("An error occured while comparing the images: ",e),n.setState({errorMessage:"An error occured while comparing the images: ".concat(e)});else{var a=t.getImageDataUrl();n.setState({diffImage:a})}},n.state={diffImage:null,errorMessage:null},n}return Object(P.a)(a,[{key:"render",value:function(){return this.state.errorMessage?r.a.createElement("div",null,this.state.errorMessage):this.state.diffImage?r.a.createElement("div",{className:"diff-view"},r.a.createElement("img",{src:this.state.diffImage,alt:"Differences between the before and after pictures"}),r.a.createElement(Y,{buttonText:"Download comparison image",fileName:"before-after-compare",imageData:this.state.diffImage})):(this.calculateDiffImage(),r.a.createElement("div",null,"Comparing images..."))}},{key:"calculateDiffImage",value:function(){var e=this.props.afterImage,t=this.props.beforeImage;if(e&&t){Object(H.compare)(t,e,{output:{errorType:"movementDifferenceIntensity",largeImageThreshold:1500,useCrossOrigin:!1,outputDiff:!0},scaleToSameSize:!0,ignore:"colors"},this.resembleCallback)}else this.setState({errorMessage:"Before or after image is empty or undefined"})}}]),a}(r.a.Component),X=a(20),z=a.n(X);function J(e){return r.a.createElement("div",{className:"image-diff left-right-slider"},r.a.createElement("div",{className:"text"},"Move the slider around to compare the images."),r.a.createElement(z.a,{leftImage:e.beforeImage,leftImageLabel:"Before",rightImage:e.afterImage,rightImageLabel:"After",sliderLineColor:"red",handle:r.a.createElement(r.a.Fragment,null)}))}var K=a(24),q=(a(45),K.a),Z=function(e){Object(U.a)(a,e);var t=Object(L.a)(a);function a(e){var n;return Object(x.a)(this,a),(n=t.call(this,e)).onOpacityChange=function(e){e!==n.state.sliderValue&&n.setState({sliderValue:e})},n.state={sliderValue:50},n}return Object(P.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"img-diff crossfade"},r.a.createElement("div",{className:"slider-div"},r.a.createElement("span",null,"Before"),r.a.createElement(q,{min:0,max:100,value:this.state.sliderValue,onChange:this.onOpacityChange}),r.a.createElement("span",null,"After")),r.a.createElement("div",{className:"overlay-container"},r.a.createElement("img",{src:this.props.beforeImage,alt:""}),r.a.createElement("img",{className:"on-top",src:this.props.afterImage,alt:"",style:{opacity:this.state.sliderValue/100}})))}}]),a}(r.a.Component),Q=a(26),$=a(25);function ee(e){var t=Object($.a)(e.optionMap.entries());return r.a.createElement("select",{value:e.value,onChange:function(t){return e.onValueChange(t.target.value)}},t.map((function(e){var t=Object(Q.a)(e,2),a=t[0],n=t[1];return r.a.createElement("option",{key:a,value:a},n)})))}function te(e){return!1!==e.log&&console.warn("[BugMessage]",e.message),r.a.createElement("div",{className:"err-msg"},r.a.createElement("div",{className:"bold"},"Ooops, this should not happen. You have probably found a bug!"),e.message)}var ae=new Map;ae.set("COMPARE_AUTOMATIC","Automatic"),ae.set("COMPARE_SLIDER_RIGHT_LEFT","Slider: Right - Left"),ae.set("COMPARE_CROSSFADE","Crossfade");var ne=function(e){Object(U.a)(a,e);var t=Object(L.a)(a);function a(){return Object(x.a)(this,a),t.apply(this,arguments)}return Object(P.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"diff-view"},r.a.createElement("h2",null,"Comparison"),r.a.createElement("span",null,"Type:"),r.a.createElement(ee,{optionMap:ae,value:this.props.type,onValueChange:function(e){_({type:"SET_COMPARE_TYPE",payload:e})}}),this.renderContents())}},{key:"renderContents",value:function(){var e=this.props.beforeImage;if(!e)return r.a.createElement(te,{message:"Before image is missing"});var t=this.props.afterImage;if(!t)return r.a.createElement(te,{message:"After image is missing"});switch(this.props.type){case"COMPARE_AUTOMATIC":return r.a.createElement(W,{beforeImage:e,afterImage:t});case"COMPARE_CROSSFADE":return r.a.createElement(Z,{beforeImage:e,afterImage:t});case"COMPARE_SLIDER_RIGHT_LEFT":return r.a.createElement(J,{beforeImage:e,afterImage:t});default:return r.a.createElement(te,{message:"Unknown compare type: ".concat(this.props.type)})}}}]),a}(r.a.Component),re=Object(c.b)((function(e,t){return Object(i.a)(Object(i.a)({},t),{},{beforeImage:e.images.before.data,afterImage:e.images.after.data,type:e.comparisonType})}))(ne),oe=function(e){Object(U.a)(a,e);var t=Object(L.a)(a);function a(){return Object(x.a)(this,a),t.apply(this,arguments)}return Object(P.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"instructions"},r.a.createElement("h2",null,"How it works"),r.a.createElement("p",null,"This web application lets you detect if someone messed with your stuff. It does this by comparing pictures taken before and after you left it unsupervised. Then it highlights any differences it has found. (You could also use it to mess with peoples stuff and make sure that you leave it exactly like they left it. But don't do that: it's evil)"),r.a.createElement("h2",null,"Instructions"),r.a.createElement("ol",null,r.a.createElement("li",null,"Read these instructions"),r.a.createElement("li",null,"Select the settings you want to use"),r.a.createElement("li",null,"Take a image before you leave"),r.a.createElement("li",null,"Keep this website open (or download/save the image)"),r.a.createElement("li",null,"Take an image after you return. By default the image from before will be superimposed over the camera view to help you find the same angle / distance again"),r.a.createElement("li",null,"Check areas with detected changes (marked in pink)")))}}]),a}(r.a.Component);function se(e){return void 0===e.show||e.show?r.a.createElement("div",{className:"setting"},r.a.createElement("span",{className:"label"},e.label,e.hint&&r.a.createElement("abbr",{title:e.hint.text}," (".concat(e.hint.trigger,")"))),e.children):null}var ce=new Map;ce.set("Use webcam","Use webcam / camera"),ce.set("Upload image","Upload photos");var ie=new Map;ie.set("png","PNG"),ie.set("jpeg","JPEG"),ie.set("webp","WEBP");var le=new Map;le.set("640x480","480p"),le.set("1280x720","720p (HD)"),le.set("1920x1080","1080p (Full HD)"),le.set("3840x2160","2160p (4K UHD)");var ue=function(e){Object(U.a)(a,e);var t=Object(L.a)(a);function a(){return Object(x.a)(this,a),t.apply(this,arguments)}return Object(P.a)(a,[{key:"render",value:function(){var e=this,t="Use webcam"===this.props.imageSource;return r.a.createElement("div",{className:"settings"},r.a.createElement("h2",null,"Settings"),r.a.createElement(se,{label:"Image source"},r.a.createElement(ee,{optionMap:ce,value:this.props.imageSource,onValueChange:D})),r.a.createElement(se,{label:"Photo format",show:t},r.a.createElement(ee,{optionMap:ie,value:this.props.screenshotFormat,onValueChange:M})),r.a.createElement(se,{label:"Resolution",hint:{trigger:"*",text:"The browser will request this resolution, but depending on your hardware the actual resolution may differ"},show:t},r.a.createElement(ee,{optionMap:le,value:this.props.preferredResolution,onValueChange:this.onResolutionChange})),r.a.createElement(se,{label:"Image overlay",hint:{trigger:"?",text:"Enabling this option will overlay the image you took before on the camera view, so that you can find the alignment and position that you used before"},show:t},r.a.createElement("label",null,r.a.createElement("input",{type:"checkbox",checked:this.props.isBeforeOverlayEnabled,onChange:function(t){return a=!e.props.isBeforeOverlayEnabled,void _({type:"SET_ENABLE_BEFORE_OVERLAY",payload:a});var a}}),"help you find the same perspective again")))}},{key:"onResolutionChange",value:function(e){try{var t=e.split("x",2),a=Number(t[0]),n=Number(t[1]);_({type:"SET_PREFERRED_RES",payload:{width:a,height:n}})}catch(r){console.error('Can not parse resolution: "'.concat(e,'"'),r)}}}]),a}(r.a.Component),me=Object(c.b)((function(e,t){var a=e.settings.preferredResolution;return Object(i.a)(Object(i.a)({},t),{},{imageSource:e.settings.imageSource,screenshotFormat:e.settings.screenshotFormat,preferredResolution:"".concat(a.width,"x").concat(a.height),isBeforeOverlayEnabled:e.settings.overlayBeforeImage})}))(ue),pe=a(23),ge=a.n(pe),fe=function(e){Object(U.a)(a,e);var t=Object(L.a)(a);function a(e){var n;return Object(x.a)(this,a),(n=t.call(this,e)).webcamRef=void 0,n.onClick=function(e){var t=n.webcamRef.current.getScreenshot();t&&n.props.onPhoto(t)},n.webcamRef=r.a.createRef(),n}return Object(P.a)(a,[{key:"render",value:function(){var e=this.props.backgroundImage,t="take-image-div"+(e?" transparent-cam":""),a=C.getState().settings.screenshotFormat,n=C.getState().settings.preferredResolution,o={facingMode:{ideal:"environment"},width:{ideal:n.width},height:{ideal:n.height}};return r.a.createElement("div",{className:t},r.a.createElement(ge.a,{ref:this.webcamRef,className:"cam",onClick:this.onClick,audio:!1,videoConstraints:o,forceScreenshotSourceSize:!0,screenshotFormat:"image/".concat(a)}),e?r.a.createElement("img",{src:e,alt:"",onClick:this.onClick}):null)}}]),a}(r.a.Component);var he=function(e){return r.a.createElement("input",{className:"image-upload",type:"file",onChange:function(t){var a=t.target.files;if(a&&a[0]){var n=new FileReader;n.onload=function(t){e.setImage(t.target.result)},n.readAsDataURL(a[0])}t.target.value=null}})};var de=function(e){var t=C.getState().settings.imageSource;switch(t){case"Use webcam":return function(e){return r.a.createElement("div",{className:"get-image"},r.a.createElement("h2",null,"Take a photo"),"Allow camera access and touch/click the image below.",r.a.createElement(fe,{onPhoto:e.onImage,backgroundImage:e.backgroundImage}),r.a.createElement(Y,{buttonText:"Download last image taken",fileName:"webcam-image",imageData:e.currentImage}))}(e);case"Upload image":return function(e){return r.a.createElement("div",{className:"get-image"},r.a.createElement("h2",null,"Upload an image"),r.a.createElement(he,{setImage:e.onImage}))}(e);default:return r.a.createElement(te,{message:'Unknown image source: "'.concat(t,'"')})}};function be(e){return e.beforeImage?r.a.createElement("div",{className:"step-between"},r.a.createElement("h2",null,"Do your thing"),"Below is the image you have taken. If it is looking ok, you can go and do your stuff.",r.a.createElement("span",{className:"important-hint"}," DO NOT close or reload this tab, or the image will be lost! "),"When you return go to the next step.",r.a.createElement("br",null),"If you want to make sure you don't loose it click the ",r.a.createElement("code",null,"Download image")," button below. If you do not like the image, go back to the previous step and take another image.",r.a.createElement("img",{src:e.beforeImage,alt:""}),r.a.createElement(Y,{buttonText:"Download image",fileName:"webcam-image",imageData:e.beforeImage})):r.a.createElement("div",null,"Before image not found: please go back to the previous step")}var Ee=function(e){Object(U.a)(a,e);var t=Object(L.a)(a);function a(){return Object(x.a)(this,a),t.apply(this,arguments)}return Object(P.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"step-content"},this.renderContents(),this.renderNextButtonIfPossible())}},{key:"renderContents",value:function(){switch(this.props.step){case p:return r.a.createElement(oe,null);case g:return r.a.createElement(me,null);case f:return r.a.createElement(de,{onImage:T,currentImage:this.props.beforeImageData});case h:return r.a.createElement(be,{beforeImage:this.props.beforeImageData});case d:var e=this.props.overlayBeforeImage&&this.props.beforeImageData||void 0;return r.a.createElement(de,{onImage:R,currentImage:this.props.afterImageData,backgroundImage:e});case b:return r.a.createElement(re,null);default:return r.a.createElement(te,{message:'Unknown step: "'.concat(this.props.step,'"')})}}},{key:"renderNextButtonIfPossible",value:function(){if(E[this.props.step].canSkip){var e=this.props.step+1;if(e<E.length){return r.a.createElement("button",{className:"next-button",onClick:function(t){return A(e)}},"Next step")}}return null}}]),a}(r.a.Component),ve=Object(c.b)((function(e,t){return Object(i.a)(Object(i.a)({},t),{},{beforeImageData:e.images.before.data,afterImageData:e.images.after.data,overlayBeforeImage:e.settings.overlayBeforeImage,step:e.steps.current})}))(Ee);a(46);var Oe=Object(c.b)((function(e,t){return Object(i.a)(Object(i.a)({},t),{},{step:e.steps.current})}))((function(e){return-1===e.step?r.a.createElement("div",{className:"app"},r.a.createElement(B,null)):r.a.createElement("div",{className:"app"},r.a.createElement(V,null),r.a.createElement(ve,null))}));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(c.a,{store:C},r.a.createElement(Oe,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[27,1,2]]]);
//# sourceMappingURL=main.ab7da7c2.chunk.js.map